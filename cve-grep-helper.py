#!/usr/bin/python
# Reads the MITRE CVE list in CSV format and spits out only the desired columns.
# This is useful for searching for cves with command line tools (grep, awk, etc),
# since they don't handle CSV files very well.

# Requires the CVE list from MITRE: https://cve.mitre.org/data/downloads/index.html

import csv, sys, errno

cve_list = "/root/share/cve_list/allitems.csv"

try:
    with open(cve_list) as csvfile:
        reader = csv.DictReader(csvfile, ["Name","Status","Description","References","Phase","Votes","Comments"])
        # skip the first 10 lines (version, date, headers, "Candidates must be reviewed...")
        for i in range(10):
            reader.next()
        for row in reader:
            print(row["Name"] + "\t" + row["Description"])
except IOError as e:
    if e.errno == errno.EPIPE:
        exit(0)
